【2020年5月1日】整理自[【微擎开发文档】](http://s.w7.cc/index.php?c=wiki&do=view&id=1&list=13)


# 微擎

## 入门介绍

微擎是基于目前最流行的 WEB2.0 的架构（php+mysql），运行环境我们推荐使用：

* linux(centOS)
* nginx
* php5.3
* mysql5.6

> 更多了解可跳转自[【入门指引】](http://s.w7.cc/index.php?c=wiki&do=view&id=1&list=19)

### 环境安装

服务器环境要求：

* IIS/Apache/Nginx
* PHP>=5.6
* MySQL>=5

> 更多了解可跳转自[【环境安装】](http://s.w7.cc/index.php?c=wiki&do=view&id=1&list=26)

## 框架使用

### 入口脚本

入口脚本是应用启动流程中的第一环，入口文件根据 **`系统配置文件`** 初始化了系统的常量、全局变量及全局对象，并将终端用户的请求通过入口脚本将请求转发到各自的功能模块中

微擎系统中分为三个入口，分别是：

* Web 端入口
* App 端入口
* 微信 Api 入口

### 系统配置文件

系统配置文件存放着微擎系统重要的启动数据，文件是 `/data/config.php`

> 此文件禁止普通用户修改

### Web 端入口

Web 端入口主要负责微擎系统的后台管理功能，入口文件是 `/web/index.php`

* 访问此入口有严格的权限判断，需要用户进行登录

* 此入口主要完成以下工作：

  * 登录用户的身份验证
  * 初始化登录用户的身份信息，分派管理员权限或是操作员权限
  * 权限菜单划分及权限判断
  * 加载系统配置
  * 路由用户的请求

### App 端入口

App 端入口主要负责微擎系统的前端 **`微站`** 、**`个人中心`** 及其它普通用户访问的功能

* 入口文件是 `/app/index.php`

* 访问 **`微站`** 无需身份验证

  访问 **`个人中心`** 则要求用户进行登录

* 此入口主要完成以下工作：

  * 初始化当前公众号的数据
  * 初始化微站站点信息、风格、模板、导航等数据
  * 初始化粉丝&会员的身份信息（如果有权限获取）
  * 加载系统配置
  * 路由用户的请求

### 微信 Api 入口

微信 Api 入口主要负责处理微信公众平台请求微擎系统的关键字、图片、语音等数据

* 入口文件是 `api.php`

* 此入口只用于公众平台访问

* 此入口主要完成以下工作：

  * 初始化当前公众号的数据
  * 解析公众平台推送过来的数据结构，转化为微擎消息结构
  * 根据消息结构中的关键字或是事件匹配到相应的模块
  * 调用模块的 processor 类返回数据给微信公共平台










